---
name: Rule & Knowledge Strategy
overview: ""
todos:
  - id: 74dc28ed-ab11-4d26-9f5f-3d7568fd771d
    content: Configure Hliðskjálf UI OIDC (SSO login)
    status: pending
  - id: ab2c3685-2a39-4732-92d5-861f85ba9556
    content: Configure LangFuse OIDC
    status: pending
  - id: df086bfe-4646-44ee-b094-f4cef4493bc7
    content: Create Norns service account in Zitadel
    status: pending
  - id: f8a627c4-b229-4a81-bc28-1640ca00e42e
    content: Create RUNBOOK-006 for Zitadel
    status: pending
  - id: 1fc4e9d2-7e7d-4188-b8c9-1590f428fa2b
    content: Update PROJECT_PLAN.md with completion status
    status: pending
  - id: 0b0765fa-169b-45bd-aa5a-36034aa18d83
    content: Create Grafana Alloy configuration
    status: pending
  - id: e3e1551a-20cc-4aa3-98c8-49aa98dc5c3e
    content: Add Alloy to docker-compose.yml
    status: pending
  - id: e3644e0d-2496-4988-a367-39cea9b6d7ee
    content: Configure Loki for log ingestion
    status: pending
  - id: 55831f5c-4467-4127-9750-fcb0172abf75
    content: Configure Loki datasource in Grafana
    status: pending
  - id: fecc0263-8122-40fc-9ad8-749c181334b2
    content: Test log collection and visualization
    status: pending
  - id: 0490f9da-42a7-4ea0-a808-65bc803a953f
    content: Fix redpanda-console port conflict (8080 -> 18082)
    status: pending
  - id: 29caa0cb-0336-469b-b9bb-89cc830eef70
    content: "Add missing routes: gitlab, loki, otel, nats-monitor, spire, livekit"
    status: pending
  - id: 8c971527-4000-4829-929e-e492a2487295
    content: Remove redundant nginx proxy services from docker-compose.yml
    status: pending
  - id: b21ce420-c546-4939-9cc5-2e973c6e1553
    content: Test all routes through Traefik
    status: pending
  - id: edc5c1d1-9fce-4fcc-8d13-813210b08e41
    content: Add LocalStack auth token for persistence
    status: pending
  - id: ab6d0fb5-a933-48f2-b8ea-4d411580c0ce
    content: Expand LocalStack init script with all secrets
    status: pending
  - id: 3e19f505-79af-4e1f-afdb-7cbcbd346419
    content: Create Python SecretsClient for AWS Secrets Manager
    status: pending
  - id: 32186db6-4700-458b-9a28-cfaa4764d3b0
    content: Configure S3 buckets (artifacts, backups, logs, terraform)
    status: pending
  - id: 80f4502b-32a0-4f63-be5c-11e31f2de9fe
    content: Enable Redis AUTH with password from Secrets Manager
    status: pending
  - id: f5e54746-581e-4a14-b14f-f49ac709bc2a
    content: Store PostgreSQL credentials in Secrets Manager
    status: pending
  - id: 297c601a-39f2-4762-9795-bf7bf477012c
    content: Create database backup-to-S3 script
    status: pending
  - id: 16a02214-e215-4992-9b1e-1b79c5309654
    content: Create RUNBOOK-010 for secret rotation
    status: pending
  - id: 8e98fb76-030a-4287-a562-8812e2472a6f
    content: Update PROJECT_PLAN.md with Phase 2 completion
    status: pending
  - id: be2dcd4e-5414-43e9-8746-677e7619ea10
    content: Add LocalStack auth token for persistence
    status: pending
  - id: 3021c3c7-2028-473d-b4ef-20bd3c004535
    content: Expand LocalStack init script with all secrets
    status: pending
  - id: 95a4b13f-9e52-466a-8377-eda346ae462b
    content: Create Python SecretsClient for AWS Secrets Manager
    status: pending
  - id: 3799d156-6a16-4750-9779-1638b07bfc5a
    content: Configure S3 buckets (artifacts, backups, logs, terraform)
    status: pending
  - id: 4aca5eda-e379-4cf6-8a61-60bdc86295fd
    content: Enable Redis AUTH with password from Secrets Manager
    status: pending
  - id: 08549bcd-fb61-4391-a01c-33f4a1a5d74d
    content: Store PostgreSQL credentials in Secrets Manager
    status: pending
  - id: 3400bfba-952d-420e-a51c-b032176d7b1c
    content: Create database backup-to-S3 script
    status: pending
  - id: 3fb2724d-0ea6-4562-9afb-f054e72e5110
    content: Create RUNBOOK-010 for secret rotation
    status: pending
  - id: c0e6c53f-cdaa-4c25-a67f-591452443bf4
    content: Update PROJECT_PLAN.md with Phase 2 completion
    status: pending
  - id: ccc46d54-cc31-4b46-89dc-a6a76c9152cf
    content: Create Zitadel OIDC app for oauth2-proxy
    status: pending
  - id: 590c4126-f4ae-4072-89a3-2c80602ec3b2
    content: Deploy oauth2-proxy with Zitadel configuration
    status: pending
  - id: 937bd6bc-d829-47e5-826e-88a38924cf66
    content: Configure Traefik forwardAuth middleware
    status: pending
  - id: 9748dd99-e72f-413d-be92-3c2d8fc11f50
    content: Apply auth middleware to protected routes
    status: pending
  - id: ab22331f-9d5f-4d1c-8fb7-ea37702a1d38
    content: Test zero-trust access for all services
    status: pending
  - id: 81f3a9e0-fa2a-4475-b94b-d0586df649a9
    content: Update PROJECT_PLAN.md with Phase 3 completion
    status: pending
  - id: cebda938-5c5e-44ac-8bf2-dac6fbbda40e
    content: Configure Hliðskjálf UI OIDC (SSO login)
    status: pending
  - id: eabb50bc-9ca7-421e-a358-89f9aeab7320
    content: Configure LangFuse OIDC
    status: pending
  - id: 4a98941e-747a-4530-9599-e680033ee162
    content: Create Norns service account in Zitadel
    status: pending
  - id: 7ac08e7a-4129-482e-a233-3cecc9fc5814
    content: Create RUNBOOK-006 for Zitadel
    status: pending
  - id: c73bee16-8510-4d7f-af50-54e59ccbafe1
    content: Update PROJECT_PLAN.md with completion status
    status: pending
  - id: 8a4c52d1-112a-4b9f-ad46-74a7b82a743b
    content: Create Grafana Alloy configuration
    status: pending
  - id: 6e69f6f1-6a74-4797-9428-9ad1d6065857
    content: Add Alloy to docker-compose.yml
    status: pending
  - id: 90bfc710-e4e7-45c2-a676-7fc127a7ab92
    content: Configure Loki for log ingestion
    status: pending
  - id: 53399fb8-4588-4884-81ec-3f102ad30fce
    content: Configure Loki datasource in Grafana
    status: pending
  - id: 2f5c1af7-8353-461a-a575-8accf2121275
    content: Test log collection and visualization
    status: pending
  - id: 7209eef1-49f7-4caa-9ad6-368366f7f76a
    content: Fix redpanda-console port conflict (8080 -> 18082)
    status: pending
  - id: ee428382-d9c9-41ac-918a-f61e16df5171
    content: "Add missing routes: gitlab, loki, otel, nats-monitor, spire, livekit"
    status: pending
  - id: 6d96acda-30a6-4212-9a25-60c2e62a8708
    content: Remove redundant nginx proxy services from docker-compose.yml
    status: pending
  - id: c6c7dd41-eaf1-4560-8cb5-be7073a5102e
    content: Test all routes through Traefik
    status: pending
  - id: 696fb143-c163-41a1-9273-42207b1c9d98
    content: Add LocalStack auth token for persistence
    status: pending
  - id: 569ae3df-e3f4-4ac6-b1be-becedfcd881d
    content: Expand LocalStack init script with all secrets
    status: pending
  - id: 9e8a2086-d475-4621-a178-9bbc0fbb6a88
    content: Create Python SecretsClient for AWS Secrets Manager
    status: pending
  - id: 48ef2a00-6a75-48c0-8484-0228dcdc7337
    content: Configure S3 buckets (artifacts, backups, logs, terraform)
    status: pending
  - id: ac035ae3-4312-49d1-b5bc-0e7d221ed514
    content: Enable Redis AUTH with password from Secrets Manager
    status: pending
  - id: bfacff30-783f-43b0-9fb7-b759734ac2c6
    content: Store PostgreSQL credentials in Secrets Manager
    status: pending
  - id: d6f92cc5-2291-47e9-a270-4da9f66d69f4
    content: Create database backup-to-S3 script
    status: pending
  - id: 0ce51b80-183f-42c1-93e2-5f40960d4ef7
    content: Create RUNBOOK-010 for secret rotation
    status: pending
  - id: 3ab01bb7-3e3d-463e-8ccb-61d1e8c883a2
    content: Update PROJECT_PLAN.md with Phase 2 completion
    status: pending
  - id: 6271096e-f865-4f10-90f0-0f1088eb074a
    content: Add mcp-server-gitlab service + routing
    status: pending
  - id: 71a5ced1-3628-4ed8-8672-35297b208d19
    content: Implement MCP GitLab + knowledge tools
    status: pending
  - id: b2db86da-9156-4c6f-84a3-a02e9ddca668
    content: Wire secrets/config & docs updates
    status: pending
  - id: b65baba2-e55e-400b-b297-5aca438912f3
    content: Traefik trusts SPIRE CA for MCP backend
    status: pending
  - id: 456ba9a6-ea46-449f-8125-0035683c674a
    content: Traefik presents SPIRE client cert
    status: pending
  - id: 65a3063e-c126-468c-9604-5d1496321976
    content: Set MCP server TLS_REQUIRE_CLIENT_CERT
    status: pending
  - id: 41f46089-17e8-43fc-9e5d-b22c4b533a03
    content: Doc+verify mutual TLS rollout
    status: pending
  - id: 30b2c7b0-8601-4920-9c9d-cd52678a63c5
    content: Configure Hliðskjálf UI OIDC (SSO login)
    status: pending
  - id: 3b801d9e-088c-42ff-9fe1-4d82b2c17f73
    content: Configure LangFuse OIDC
    status: pending
  - id: 5a44d51e-c536-4242-a960-5ff13437b0e7
    content: Create Norns service account in Zitadel
    status: pending
  - id: e928cdcb-2d48-48b4-9578-5b3426bc2e45
    content: Create RUNBOOK-006 for Zitadel
    status: pending
  - id: 048737af-8369-4898-83fa-07c130ce3282
    content: Update PROJECT_PLAN.md with completion status
    status: pending
  - id: 9bb3ba3e-c595-4f1b-b387-0ff375d9717d
    content: Create Grafana Alloy configuration
    status: pending
  - id: a7094b59-8adf-4bdc-8409-6310f3efd00e
    content: Add Alloy to docker-compose.yml
    status: pending
  - id: 1b6a78f7-a0cd-4079-b184-271f24b03b2d
    content: Configure Loki for log ingestion
    status: pending
  - id: 67085344-0adf-4651-8a4b-b1c4f1a891c8
    content: Configure Loki datasource in Grafana
    status: pending
  - id: f2b2404f-05db-48c4-b55d-a804da9a90e1
    content: Test log collection and visualization
    status: pending
  - id: e8d4c2e0-e05f-4180-9961-7e9ef0f6bad4
    content: Fix redpanda-console port conflict (8080 -> 18082)
    status: pending
  - id: 962005f1-8370-4e7e-b00a-2e97dd4feec8
    content: "Add missing routes: gitlab, loki, otel, nats-monitor, spire, livekit"
    status: pending
  - id: f967fa35-e41a-4c7e-9ad1-f306e4d0334b
    content: Remove redundant nginx proxy services from docker-compose.yml
    status: pending
  - id: 170b043a-d8db-4866-8009-763a46a9ad8a
    content: Test all routes through Traefik
    status: pending
  - id: b31cecce-08a4-4b28-a739-1d6dbb102080
    content: Add LocalStack auth token for persistence
    status: pending
  - id: 19c03e65-44ff-447f-b70c-6421a42afa80
    content: Expand LocalStack init script with all secrets
    status: pending
  - id: fe88eed8-23e9-42ab-bc2a-bf961f9e62f1
    content: Create Python SecretsClient for AWS Secrets Manager
    status: pending
  - id: 886e345e-7d2c-473b-882c-d8f4338880b2
    content: Configure S3 buckets (artifacts, backups, logs, terraform)
    status: pending
  - id: 6f50c196-424c-4f09-b4ec-3631138b26da
    content: Enable Redis AUTH with password from Secrets Manager
    status: pending
  - id: 5a50aead-eaea-45b8-ba7a-651e867ae681
    content: Store PostgreSQL credentials in Secrets Manager
    status: pending
  - id: baed35a7-37ed-4dbc-bc28-b037b9e91cc6
    content: Create database backup-to-S3 script
    status: pending
  - id: 91028282-2355-4db5-acda-245d54311ab2
    content: Create RUNBOOK-010 for secret rotation
    status: pending
  - id: 18d6b055-d048-4d10-b650-532012e247ac
    content: Update PROJECT_PLAN.md with Phase 2 completion
    status: pending
  - id: a5c4da7b-9c99-4742-80c5-0d8308b4c034
    content: Add LocalStack auth token for persistence
    status: pending
  - id: 2234cf71-f0e8-405c-be18-bbd66cb78bb9
    content: Expand LocalStack init script with all secrets
    status: pending
  - id: a6029955-c726-4591-b318-b0f91611882b
    content: Create Python SecretsClient for AWS Secrets Manager
    status: pending
  - id: 0ebb0209-1c65-447b-839e-0d74f4226e47
    content: Configure S3 buckets (artifacts, backups, logs, terraform)
    status: pending
  - id: 6eca7f57-75af-4ae6-bc39-aa492e86a5be
    content: Enable Redis AUTH with password from Secrets Manager
    status: pending
  - id: 2d37ba54-81be-4ca9-bbf6-83bf581dac07
    content: Store PostgreSQL credentials in Secrets Manager
    status: pending
  - id: 77a74795-a2a6-45c3-8b31-c0f284bc1dbd
    content: Create database backup-to-S3 script
    status: pending
  - id: 546f742c-ff12-41cf-a244-7de0fe11ac0e
    content: Create RUNBOOK-010 for secret rotation
    status: pending
  - id: e18508ca-13a3-47b1-8747-ec83730b8031
    content: Update PROJECT_PLAN.md with Phase 2 completion
    status: pending
  - id: 2272a381-9ac1-4b7d-991b-62e9e393e8dc
    content: Create Zitadel OIDC app for oauth2-proxy
    status: pending
  - id: 9ba289c1-04c5-43d4-9e9f-c7c14b3bd222
    content: Deploy oauth2-proxy with Zitadel configuration
    status: pending
  - id: 9e0040b3-9472-4463-90c3-fa7ceb1018ee
    content: Configure Traefik forwardAuth middleware
    status: pending
  - id: 4159a8a3-7ebf-4225-9652-845c98537783
    content: Apply auth middleware to protected routes
    status: pending
  - id: 1f15804a-e3d8-4a2b-ad92-ba61e27dbce4
    content: Test zero-trust access for all services
    status: pending
  - id: 58543bdb-3d55-41de-a5bc-9610ca1f15e2
    content: Update PROJECT_PLAN.md with Phase 3 completion
    status: pending
  - id: 209f4619-d1c9-4590-bdc8-c1f467b4b7d0
    content: Configure Hliðskjálf UI OIDC (SSO login)
    status: pending
  - id: 9d1a0ff7-faf8-4151-bb33-b1eb1639580d
    content: Configure LangFuse OIDC
    status: pending
  - id: a7ec5fcc-c94f-4758-9a3f-e19c8318c138
    content: Create Norns service account in Zitadel
    status: pending
  - id: f1744d98-923b-4683-9eff-48572692e757
    content: Create RUNBOOK-006 for Zitadel
    status: pending
  - id: 6952af86-605f-4cdc-ae40-2d78b29058bf
    content: Update PROJECT_PLAN.md with completion status
    status: pending
  - id: f4994c6d-21da-4098-9361-8077fe5aa5a8
    content: Create Grafana Alloy configuration
    status: pending
  - id: 9efbb15a-6195-4d5e-8697-c1aa72525511
    content: Add Alloy to docker-compose.yml
    status: pending
  - id: 52a4a8b0-a0c2-431b-b2c7-d9f9819a984d
    content: Configure Loki for log ingestion
    status: pending
  - id: b2516721-e4e9-4ad4-a3c4-7baafbcffeab
    content: Configure Loki datasource in Grafana
    status: pending
  - id: 62c5a7d8-c8ba-4da4-b8f9-5d2c858e0dac
    content: Test log collection and visualization
    status: pending
  - id: 591abe80-cf36-42f1-bf99-eafe8b5219f8
    content: Fix redpanda-console port conflict (8080 -> 18082)
    status: pending
  - id: 447b622c-645a-4904-978a-09d54cd294ba
    content: "Add missing routes: gitlab, loki, otel, nats-monitor, spire, livekit"
    status: pending
  - id: e38d4e7c-2b57-4669-9fff-c0e8aba22625
    content: Remove redundant nginx proxy services from docker-compose.yml
    status: pending
  - id: 789d10cd-7c59-42a6-9e71-0431f8c3b747
    content: Test all routes through Traefik
    status: pending
  - id: 74aec1cb-bd5f-4f01-8bdb-c68437d685bb
    content: Add LocalStack auth token for persistence
    status: pending
  - id: 028c64d0-006b-4851-99b9-f23678872b50
    content: Expand LocalStack init script with all secrets
    status: pending
  - id: ed649b51-2e5f-4d1e-99e7-8123cc8b5830
    content: Create Python SecretsClient for AWS Secrets Manager
    status: pending
  - id: 86e394ed-24e1-4288-86e2-aef66a11b81e
    content: Configure S3 buckets (artifacts, backups, logs, terraform)
    status: pending
  - id: 951cae02-bd74-4836-93d7-e04069ea36dc
    content: Enable Redis AUTH with password from Secrets Manager
    status: pending
  - id: a01b0697-fed1-4c78-81f2-52a05eb04d44
    content: Store PostgreSQL credentials in Secrets Manager
    status: pending
  - id: bf8d970b-4fec-4f70-aca6-3a1cb3e0309e
    content: Create database backup-to-S3 script
    status: pending
  - id: d0f71d87-380e-4c64-9c05-e2fcc899419a
    content: Create RUNBOOK-010 for secret rotation
    status: pending
  - id: 6b6d0906-2262-4382-886d-f7301875e10c
    content: Update PROJECT_PLAN.md with Phase 2 completion
    status: pending
---

# Rule & Knowledge Strategy

## Objectives

- Capture the critical project knowledge (architecture, secrets, workflows, runbooks) as Cursor rules so future sessions start with consistent guidance.
- Determine which instructions belong in project-wide rules vs. nested rules vs. AGENTS.md.
- Ensure rules point to living documentation (runbooks, design docs) instead of duplicating large content.

## Implementation Steps

1. **Inventory existing knowledge sources**  

- Categorize docs (architecture, security, observability, MCP, service onboarding) and list which ones should be referenced by rules.  
- Identify sensitive info (secrets, tokens) and replace with pointers to LocalStack/Vault workflows.

2. **Define rule hierarchy & scope**  

- Decide the top-level instructions for `.cursor/rules` (communication style, high-level architecture, secrets handling).  
- Plan nested rule directories (e.g., `services/mcp-server-gitlab/.cursor/rules`, `ravenhelm-proxy/.cursor/rules`) for domain-specific guidance.  
- Decide where AGENTS.md can provide quick-start instructions (root + submodules).

3. **Author or update rules**  

- Create concise MDC files referencing docs/runbooks/port registry, focusing on actionable steps (e.g., “See RUNBOOK-024 for adding services”).  
- Include sections for secrets retrieval (LocalStack script paths), design overviews (from `PROJECT_PLAN.md`, `MCP_SERVER_DESIGN.md`), and process checklists.  
- Ensure AGENTS.md (if used) summarizes operating procedures without duplicating rule content.

4. **Review & iterate**  

- Validate that rules render correctly in Cursor (no >500 lines, actionable language).  
- Share with the team, collect feedback, and adjust scope/wording. That way the rules remain accurate as docs evolve.