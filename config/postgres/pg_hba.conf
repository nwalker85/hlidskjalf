# PostgreSQL Host-Based Authentication with mTLS
# ================================================
# Requires client certificates for all connections

# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Local connections (Unix socket) - trust for local admin
local   all             postgres                                trust
local   all             all                                     trust

# IPv4 connections - require SSL with client cert verification
# hostssl = require SSL, cert = require valid client certificate
hostssl all             all             0.0.0.0/0               cert

# IPv6 connections - require SSL with client cert verification  
hostssl all             all             ::/0                    cert

# Replication (if needed)
# hostssl replication    replication     0.0.0.0/0               cert

